<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
	<sql-query name="index_photo">
     <![CDATA[
     	SELECT ph.HEADPHOTOPATH AS photo
		FROM t_portal_userphoto ph,(
			SELECT PK_T_PORTAL_ACCOUNT_USERID AS ID
			FROM t_portal_account 
			WHERE UID = :uid ) temp
		WHERE ph.ACCOUNT = temp.ID ;
     ]]>
    </sql-query>
    
    <sql-query name="index_phrase" >
    	<![CDATA[
    	SELECT PHRASE
		FROM t_portal_moodphrase
		WHERE ACCOUNT IN (
			SELECT PK_T_PORTAL_ACCOUNT_USERID
			FROM t_portal_account
			WHERE UID = :uid
		) 
		ORDER BY CREATETIME DESC
		LIMIT 1
    	]]>
    </sql-query>

	<sql-query name="index_find_sub_by_module">
		<![CDATA[
		SELECT
			sub.id,
			sub.createrId,
			sub.createTime,
			sub.content,
			sub.flag,
			sub.departmentId,
			sub.title,
			sub.moduleId,
			sub.lastUpdateTime,
			sub.parentId,
			sub.createrName
		FROM t_sm2_subject sub,
			(
				SELECT sub_id,flag
				FROM t_sm2_subject_master
				WHERE user_uid = :uid
			) master 
		WHERE sub.moduleId = :moduleId
		ORDER BY master.flag ASC ,sub.lastUpdateTime DESC
		LIMIT :size
		]]>
	</sql-query>
</hibernate-mapping>
